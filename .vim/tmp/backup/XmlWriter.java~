
package de.hs_mannheim.servlets ; 

import java.io.FileOutputStream; 

import javax.xml.stream.XMLEventWriter; 
import javax.xml.stream.XMLEventFactory; 
import javax.xml.stream.XMLOutputFactory; 
import javax.xml.stream.XMLStreamException; 
import javax.xml.stream.events.EndElement; 
import javax.xml.stream.events.StartDocument; 
import javax.xml.stream.events.Attribute; 
import javax.xml.stream.events.Characters; 
import javax.xml.stream.events.StartElement; 
import javax.xml.stream.events.XMLEvent; 

public class XmlWriter{

    private String fileName; 

    public XmlWriter()
    {
        //Nothing to do for the Std Constructor 
    }

    public XmlWriter( String fileName )
    {
        this.fileName = fileName; 
    }

    public void setFile( String fileName )
    {
        this.fileName = fileName;  
    }

    private void createSingleNode( XMLEventWriter evWriter, String nodeName, String attrName , String attrvalue)
        throws XMLStreamException 
    {
        XMLEventFactory eventFactory = XMLEventFactory.newInstance(); 
        XMLEvent end = eventFactory.createDTD("\n"); 
        XMLEvent tab  = eventFactory.createDTD("\t");

        EndElement el = eventFactory.createEndElement("","",nodeName); 
        javax.xml.stream.events.Attribute attr= eventFactory.createAttribute(attrName,attrvalue); 
        evWriter.add(el); 
        evWriter.add(attr); 
    }


    private void createNode( XMLEventWriter evWriter, String name, String value)
        throws XMLStreamException 
    { 
        XMLEventFactory eventFactory = XMLEventFactory.newInstance(); 
        XMLEvent end = eventFactory.createDTD("\n"); 
        XMLEvent tab  = eventFactory.createDTD("\t");

        StartElement sEl = eventFactory.createStartElement("","",name); 
        evWriter.add(tab); 
        evWriter.add(sEl); 


        Characters characters = eventFactory.createCharacters( value ); 
        evWriter.add( characters ); 

        EndElement eEl = eventFactory.createEndElement("","",name); 
        evWriter.add(eEl); 
        evWriter.add(end); 
    }



    public void saveFile()throws Exception{
        XMLOutputFactory output = XMLOutputFactory.newInstance(); 

        XMLEventWriter evenWriter = output.createXMLEventWriter(
                new FileOutputStream( fileName )); 

        XMLEventFactory evFactory = XMLEventFactory.newInstance(); 
        XMLEvent end = evFactory.createDTD("\n"); 

        StartDocument startDocument = evFactory.createStartDocument(); 
        evenWriter.add(startDocument); 
    

        StartElement configStartElement = evFactory.createStartElement("", 
                "","bilder"); 
        evenWriter.add( configStartElement ); 
        evenWriter.add( end ); 

        createSingleNode( evenWriter, "img", "src", "myImage.jpg"); 

        evenWriter.add(evFactory.createEndElement("","","bilder")); 
        evenWriter.add(end); 
        evenWriter.add(evFactory.createEndDocument()); 
        evenWriter.close(); 
    }

    public static void main(String[] args)
    {
        XmlWriter foo = new XmlWriter() ; 

            foo.setFile("/home/batlab/config2.xml"); 

        try{
            foo.saveFile(); 
        }catch( Exception e)
        {
            e.printStackTrace();  
        }
        
    }
}
