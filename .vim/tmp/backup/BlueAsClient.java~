package de.example.bluetooth1;

import java.util.ArrayList;
import java.util.Set;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ListView;
import android.widget.Toast;
import android.bluetooth.*; 
import android.content.Intent;  

    public class BlueAsClient extends Activity {

        private BluetoothAdapter b_adapt; 
        private final static int REQUEST_ENABLE_BT = 4;  
        private Set<BluetoothDevice>pairedDevices;
        ListView lv; 
        Button on,off,list,findServer,exit,b_visible;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_blue_as_client);
        

                b_adapt = BluetoothAdapter.getDefaultAdapter(); 
                
                findServer = (Button)findViewById(R.id.button1);
                exit       = (Button)findViewById(R.id.button2);
                on         = (Button)findViewById(R.id.button3);
                off        = (Button)findViewById(R.id.button4);
                list       = (Button)findViewById(R.id.button5);
                lv         = (ListView)findViewById(R.id.listView1);
                b_visible  = (Button)findViewById(R.id.buttonvis);

    }
    
      public void list(View view){
          pairedDevices = b_adapt.getBondedDevices();

          ArrayList list = new ArrayList();
          for(BluetoothDevice bt : pairedDevices)
             list.add(bt.getName());

          Toast.makeText(getApplicationContext(),"Showing Paired Devices",
          Toast.LENGTH_SHORT).show();
          
          final ArrayAdapter adapter = new ArrayAdapter
          (this,android.R.layout.simple_list_item_1, list);
          lv.setAdapter(adapter);

          adapter.setOnClickListener( new OnItemClickListener() {
          
              public void onItemClick( AdapterView<?> parent, View view, int position, long id)
                {
                    //TextView textview = ( TextView ) view.findViewById( R.id.list_content); 
                    String text = lv.get( position ).toString().trim(); 

             Toast.makeText(getApplicationContext(),"Connect with"+text,
             Toast.LENGTH_LONG).show();
                    
                }
          
          
          });
          
      }

      public void on(View view){
          if (!b_adapt.isEnabled()) {
             Intent turnOn = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
             startActivityForResult(turnOn, 0);
             Toast.makeText(getApplicationContext(),"Turned on" 
             ,Toast.LENGTH_LONG).show();
          }
          else{
             Toast.makeText(getApplicationContext(),"Already on",
             Toast.LENGTH_LONG).show();
             }
       }

    public void  connect_with_paired( ListView view )
    {
    }

     /*****************************************************************************
      *name       : findServer 
      *args       : View view 
      *Description: Funktion sucht nach Bluetooth Verbindung in der Naehe, 
      *             Diese Bluetooth Verbindung muss Server eigenschaften besitzen
      *****************************************************************************/
      public void findServer( View view)
      {
          //Not implements jetzt
      }
      
      public void exit( View view )
      {
          
      }
    
      public void off(View view){
          b_adapt.disable();
          Toast.makeText(getApplicationContext(),"Turned off",Toast.LENGTH_LONG).show();
       }
      

       public void visible(View view){
              Intent getVisible = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
              startActivityForResult(getVisible, 0);
       }

      
    @Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
        
    }
    
    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
             
    }
    
    @Override
    protected void onstart() {
        // todo auto-generated method stub
        super.onstart();
        
    }
    

    protected void onCreateOptionMenu( Menu menu)
    {
        super.onCreateOptionsMenu( menu ); 

    }
    
    
    protected void discoveryServer()
    {
        b_adapt.startDiscovery(); 
    }


   
}// end of the class 
